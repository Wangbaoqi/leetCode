---
title: ApplicationLayer of Network
excerpt: 应用层是网络协议栈中最上的一层，也是网络通信的第一层，其提供了让两个设备进行信息交换的服务。
type: Post
coverImage: 'https://media.wangbaoqi.tech/assets/blog/react/cover/api.webp'
date: '2022-02-14'
author: NateWang
authorIcon: 'https://media.wangbaoqi.tech/assets/authors/logo.png'
tags:
  - Network
category: Network
---

应用层是网络协议栈中最上的一层，也是网络通信的第一层，其提供了让两个设备进行信息交换的服务。
定义了信息交换的格式，然后吧定义好的信息交给下一层（传输层）去传输。

应用层主要有硬件和软件两部分组成：
- 硬件：手机、电脑、服务器
- 软件：网络协议（HTTP、DNS）

网络通信其实就是两个设备中的应用程序之间进行通信，也被称为**进程通信**。

常见的网络应用程序的架构：
- CS架构：客户端/服务端。常见的有Web应用，文件传输、远程登录以及电子邮件。
- P2P架构：任何两个主机之间可以直接通信，其中主机既可以当做服务器、也可以当做客户端。常见的应用有文件分享应用、对等下载加速器以及网络电话视频应用等。
- 混合架构：既使用CS，又使用P2P，如**即时消息软件**中，服务器用于记录用户的IP和信息，而用户与用户之间直接进行通信。


## 应用层中的协议

在应用层中常见的应用以及其协议

| 应用             |  应用架构       | 应用层协议             |  传输层协议
| -----------      | -----------    | -----------           | -----------
| Web应用          | CS             | HTTP                   | TCP
| 远程终端登录      | CS             | Telnet                 | TCP
| 电子邮件          | CS             | SMTP                   | TCP
| 文件传输          | CS             | FTP                    | TCP
| 流媒体            | CS             | HTTP                    | TCP
| 文件分享          | P2P            | BitTorrent              | TCP

**应用层中的协议**

- **Telnet(远程登录)**: 它有助于终端仿真。它允许Telnet客户端访问Telnet服务器的资源。它用于管理互联网上的文件。它用于交换机等设备的初始设置。telnet命令是使用Telnet协议与远程设备或系统进行通信的命令。telnet的端口号是23。
- **FTP**：它实际上是让我们传输文件的协议。它可以在任何两台使用它的机器之间促进这一点。但 FTP 不仅仅是一个协议，而且还是一个程序。FTP 通过可靠、高效的数据传输促进通过远程计算机共享文件。FTP 的端口号为 20（用于数据）和 21（用于控制）。
- **TFTP**: 简单文件传输协议 (TFTP) 是 FTP 的精简版、普通版本，但如果您确切地知道自己想要什么以及在哪里可以找到它，那么它就是您的首选协议。它是一种在网络设备之间传输文件的技术，是FTP的简化版本。TFTP 的端口号是 69。
- **NFS**：它代表网络文件系统。它允许远程主机通过网络挂载文件系统，并与这些文件系统进行交互，就像它们在本地挂载一样。这使系统管理员能够将资源整合到网络上的集中式服务器上。NFS的端口号是2049。
- **SMTP**: 它代表简单邮件传输协议。它是TCP/IP协议的一部分。使用名为“存储和转发”的进程，SMTP在网络上和网络之间移动您的电子邮件。它与称为邮件传输代理（MTA）的东西密切合作，将您的通信发送到正确的计算机和电子邮件收件箱。SMTP的端口号是25。
- **LPD**：它代表Line Printer Daemon。它专为打印机共享而设计。它是接收和处理请求的部分。“守护进程”是服务器或代理。LPD的端口号是515。
- **X window**：它定义了用于编写基于图形用户界面的客户端/服务器应用程序的协议。这个想法是允许一个称为客户端的程序在一台计算机上运行。它主要用于互联大型机的网络。X窗口的端口号从6000开始，每台服务器增加1。
- **SNMP**： 它代表简单网络管理协议。它通过以固定或随机的间隔从管理站轮询网络上的设备来收集数据，要求它们披露某些信息。这是服务器可以共享有关其当前状态的信息的一种方式，也是管理员可以修改预定义值的通道。SNMP的端口号是161（TCP）和162（UDP）。
- **DNS**：它代表域名系统。因此，每次您使用域名时，DNS服务都必须将该名称转换为相应的IP地址。例如，域名www.abc.com可能会翻译为198.105.232.4。DNS的端口号是53。
- **DHCP**：它代表动态主机配置协议（DHCP）。它向主机提供IP地址。当主机在DHCP服务器注册IP地址时，DHCP服务器可以向主机提供大量信息。DHCP的端口号是67、68。
- **HTTP/HTTPS**：HTTP代表超文本传输协议，HTTPS是HTTP更安全的版本，这就是为什么HTTPS代表超文本传输协议安全。该协议用于访问万维网的数据。超文本是组织良好的文档系统，用于链接文本文档中的页面。
- **POP**: POP代表邮局协议，最新版本被称为POP3（邮局协议第3版）。这是用户代理用于从邮件服务器检索消息的简单协议。
- **IRC**: IRC代表互联网中继聊天。这是一个基于文本的即时消息/聊天系统。IRC用于群组或一对一通信。它还支持聊天中的文件、媒体、数据共享。它适用于客户端-服务器模型。用户通过一些网络/独立应用程序连接到IRC服务器或IRC网络。
- **MIME**: MIME代表多用途互联网邮件扩展。该协议旨在扩展现有互联网电子邮件协议（如SMTP）的功能。MIME允许通过SMTP发送非ASCII数据。它允许用户通过互联网发送/接收各种文件，如音频、视频、程序等。MIME不是一个独立的协议，它与其他协议合作以扩展其功能。

## DNS

<Intro>

域名系统（DNS）是IP地址转换服务的主机名。DNS是在名称服务器层次结构中实现的分布式数据库。它是一种用于客户端和服务器之间消息交换的应用程序层协议。这是互联网运行所必需的。

每个主机都通过IP地址识别，但记住数字对人们来说非常困难，IP地址也不是静态的，因此需要映射才能将域名更改为IP地址。因此，DNS用于将网站的域名转换为其数字IP地址。

</Intro>

**域名的类型**

- 通用域名(Generic domains): com（商业）、.edu（教育）、.mil（军事）、.org（非营利组织）、.net（类似于商业）所有这些都是通用域名。
- 国家域名(Country domains): .cn(china)、.us、.uk
- 逆域(Inverse domain): 如果我们想知道网站的域名是什么。如果想知道的话。Ip到域名映射。因此，DNS可以提供映射，例如查找`wangbaoqi.tech`的IP地址，然后我们必须键入

```shell
nslookup www.wangbaoqi.tech
```

**域名的层级**

1. 第一层（根域名DNS服务器）：管理下一层顶级DNS服务器地址，它由无法解析名称的名称服务器联系。如果名称映射未知，它会与权威名称服务器联系。然后，它获取映射并将IP地址返回给主机。
2. 第二层（顶级域名DNS服务）：管理下一层权威域名DNS服务器地址，它负责com、org、edu等，以及所有顶级国家域，如uk、fr、ca、in等。他们拥有有关权威域服务器的信息，并知道二级域的每个权威名称服务器的名称和IP地址。
3. 第三次（权威域名DNS服务）：是组织的DNS服务器，为组织服务器的IP映射提供权威主机名。它可以由组织或服务提供商维护。为了到达cse.dtu.in，我们必须询问根DNS服务器，然后它将指向顶级域服务器，然后指向实际包含IP地址的权威域名服务器。因此，权威域服务器将返回关联IP地址。

**域名的工作过程**

![dns process](https://media.wangbaoqi.tech/assets/blog/network/applicationLayer/DNS_3.png)

客户端机器向本地名称服务器发送请求，如果根在其数据库中找不到地址，则向根名称服务器发送请求，根名称服务器将把查询路由到顶级域（TLD）或权威名称服务器。根名称服务器还可以包含一些主机名到IP地址映射。顶级域（TLD）服务器总是知道谁是权威名称服务器。因此，最终将IP地址返回到本地名称服务器，而本地名称服务器又将IP地址返回给主机。

例如要查找域名`cse.dtu.in`的IP地址，有以下过程：

1. host 请求 > local name server
2. local name server >(请求) root name server >(响应) 查询 `in top name server` 的IP地址
3. local name server >(请求) top name server >(响应) 查询 `dtb.in auth name server` 的IP地址
4. local name server >(请求) auth name server >(响应) 查询 `cse.dtb.in` 对应的IP地址
5. local name server 得到最终的IP地址，返回给host

关于DNS的更多的工作细节，请查阅[working of dns server](https://www.geeksforgeeks.org/working-of-domain-name-system-dns-server/)


## HTTP

我们所熟知的Web应用程序、Web服务器等都是通过**HTTP**来通信的，它也是应用层的协议，全称 **超文本传输协议**。

接下来解释关于HTTP协议中相关的术语：

- **资源**：也可以称为Web资源，有静态资源(文件、图片等)和动态资源(应用程序动态生成)
- **媒体类型**：在网络上传输的数据都有类型，再通过HTTP传输时，会给传输的对象打上名为 **MIME类型**的标签，[MIME List](https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types)
- **URL**: 统一资源定位符，资源标识符的常见方式，它标识了资源在服务器上的位置以及如何访问它。更多[URL Spec](https://url.spec.whatwg.org/)
- **URN**: 统一资源名，URN作为资源唯一的名称。
- **事务**：是由请求和响应组成，通过HTTP报文进行的，包括请求方法、状态码等。
- **[报文](/computer/network/httpMessage)**：报文有请求和响应报文，是请求和响应的数据载体。
- **代理**：位于客户端和服务器之间的HTTP中间实体
- **[缓存](/computer/network/httpCache)**：Web缓存和代理缓存是一种特殊的代理服务器。
- **网关**：是一种特殊的服务器，作为其他服务器之间的中间实体使用，通常用于将HTTP流量转换成其他的协议。
- **cookie**: 是一种当前识别用户，实现持久会话的方式。
- **隧道**：常见的用途是通过HTTP连接承接加密的安全套接字层（SSL）
- **Agent代理**：代表用户发起请求的客户端程序，常见的有Web浏览器等。





## Reference

- [RFC2616](https://www.ietf.org/rfc/rfc2616.txt)